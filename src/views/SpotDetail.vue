<template>
    <div class="spot-detail-page">
        <!-- È°∂ÈÉ®ÂØºËà™ -->
        <van-nav-bar 
            :title="spotInfo?.name || 'ÈíìÁÇπËØ¶ÊÉÖ'" 
            left-arrow 
            @click-left="$router.back()"
        >
            <template #right>
                <van-icon name="share-o" @click="shareSpot" />
            </template>
        </van-nav-bar>

        <div v-if="loading" class="loading-container">
            <van-loading size="24px" vertical>Âä†ËΩΩ‰∏≠...</van-loading>
        </div>

        <div v-else-if="spotInfo" class="spot-content">
            <!-- ÈíìÁÇπÂõæÁâáÂ±ïÁ§∫ -->
            <div class="spot-images">
                <van-swipe 
                    v-if="spotInfo.images && spotInfo.images.length > 0"
                    :autoplay="3000" 
                    indicator-color="white"
                >
                    <van-swipe-item v-for="(image, index) in spotInfo.images" :key="index">
                        <img 
                            :src="image" 
                            :alt="`${spotInfo.name} ÂõæÁâá${index + 1}`"
                            class="spot-image"
                        />
                    </van-swipe-item>
                </van-swipe>
                <div v-else class="no-image">
                    <van-icon name="photo-o" size="48" />
                    <p>ÊöÇÊó†ÂõæÁâá</p>
                </div>
            </div>

            <!-- Âü∫Êú¨‰ø°ÊÅØ -->
            <div class="spot-basic-info">
                <div class="spot-header">
                    <h1 class="spot-name">{{ spotInfo.name }}</h1>
                    <div class="spot-type-badge" :class="spotInfo.type">
                        {{ getSpotTypeText(spotInfo.type) }}
                    </div>
                </div>

                <div class="address-section">
                    <van-icon name="location-o" />
                    <span class="address">{{ spotInfo.address }}</span>
                    <van-button 
                        type="primary" 
                        size="small" 
                        @click="navigateToSpot"
                    >
                        ÂØºËà™
                    </van-button>
                </div>
            </div>

            <!-- È±ºÁßç‰ø°ÊÅØ -->
            <div class="fish-species-section">
                <h3>ÂèØÈíìÈ±ºÁßç</h3>
                <div class="fish-tags">
                    <van-tag 
                        v-for="fish in spotInfo.fishSpecies" 
                        :key="fish" 
                        type="primary" 
                        plain
                        class="fish-tag"
                    >
                        üêü {{ fish }}
                    </van-tag>
                </div>
            </div>

            <!-- ËØ¶ÁªÜÊèèËø∞ -->
            <div class="description-section">
                <h3>ÈíìÁÇπ‰ªãÁªç</h3>
                <p class="description-text">{{ spotInfo.description }}</p>
            </div>

            <!-- Â§©Ê∞î‰ø°ÊÅØ -->
            <div class="weather-section">
                <h3>Â§©Ê∞î‰ø°ÊÅØ</h3>
                <div class="weather-card" @click="goToWeatherDetail">
                    <div class="weather-main">
                        <div class="weather-left">
                            <div class="temperature">{{ weather.temperature }}¬∞C</div>
                            <div class="weather-desc">{{ weather.weather }}</div>
                        </div>
                        <div class="weather-right">
                            <div class="weather-icon">üå§Ô∏è</div>
                        </div>
                    </div>
                    <div class="weather-details">
                        <div class="weather-item">
                            <span class="label">ÊπøÂ∫¶</span>
                            <span class="value">{{ weather.humidity }}%</span>
                        </div>
                        <div class="weather-item">
                            <span class="label">Ê∞îÂéã</span>
                            <span class="value">{{ weather.pressure }}hPa</span>
                        </div>
                        <div class="weather-item">
                            <span class="label">È£éÈÄü</span>
                            <span class="value">{{ weather.windSpeed }}m/s</span>
                        </div>
                        <div class="weather-item">
                            <span class="label">ÈÄÇÈíìÊåáÊï∞</span>
                            <span class="value suitability" :class="getSuitabilityClass(weather.suitabilityIndex)">
                                {{ weather.suitabilityIndex }}/10
                            </span>
                        </div>
                    </div>
                    <div class="click-hint">
                        <van-icon name="arrow" />
                        <span>ÁÇπÂáªÊü•ÁúãËØ¶ÁªÜÂ§©Ê∞î‰ø°ÊÅØ</span>
                    </div>
                </div>
            </div>

            <!-- Ê∞¥Êñá‰ø°ÊÅØ -->
            <div v-if="spotInfo.hydrologyInfo" class="hydrology-section">
                <h3>Ê∞¥Êñá‰ø°ÊÅØ</h3>
                <div class="hydrology-card" @click="goToWaterDetail">
                    <div class="hydrology-header">
                        <div class="update-time">
                            Êõ¥Êñ∞Êó∂Èó¥Ôºö{{ formatHydrologyTime(spotInfo.hydrologyInfo.updateTime) }}
                        </div>
                        <van-button 
                            type="primary" 
                            size="small" 
                            @click.stop="refreshHydrology"
                        >
                            Âà∑Êñ∞
                        </van-button>
                    </div>
                    
                    <div class="hydrology-main">
                        <div class="hydrology-item">
                            <div class="hydrology-icon">üåä</div>
                            <div class="hydrology-content">
                                <div class="hydrology-label">Ê∞¥‰Ωç</div>
                                <div class="hydrology-value">{{ spotInfo.hydrologyInfo.waterLevel }}Á±≥</div>
                            </div>
                        </div>
                        <div class="hydrology-item">
                            <div class="hydrology-icon">üå°Ô∏è</div>
                            <div class="hydrology-content">
                                <div class="hydrology-label">Ê∞¥Ê∏©</div>
                                <div class="hydrology-value">{{ spotInfo.hydrologyInfo.waterTemperature }}¬∞C</div>
                            </div>
                        </div>
                        <div class="hydrology-item">
                            <div class="hydrology-icon">üíß</div>
                            <div class="hydrology-content">
                                <div class="hydrology-label">Ê∞¥Ë¥®</div>
                                <div class="hydrology-value" :class="getWaterQualityClass(spotInfo.hydrologyInfo.waterQuality)">
                                    {{ spotInfo.hydrologyInfo.waterQuality }}
                                </div>
                            </div>
                        </div>
                        <div class="hydrology-item">
                            <div class="hydrology-icon">üëÅÔ∏è</div>
                            <div class="hydrology-content">
                                <div class="hydrology-label">ÈÄèÊòéÂ∫¶</div>
                                <div class="hydrology-value">{{ spotInfo.hydrologyInfo.waterClarity }}cm</div>
                            </div>
                        </div>
                    </div>
                    <div class="click-hint">
                        <van-icon name="arrow" />
                        <span>ÁÇπÂáªÊü•ÁúãËØ¶ÁªÜÊ∞¥Êñá‰ø°ÊÅØ</span>
                    </div>
                </div>
            </div>

            <!-- ÈíìÁÇπÊîªÁï• -->
            <div class="strategy-section">
                <div class="strategy-header">
                    <h3>ÈíìÁÇπÊîªÁï• ({{ reviews.length }})</h3>
                    <van-button 
                        type="primary" 
                        size="small" 
                        @click="showReviewDialog = true"
                    >
                        ÂàÜ‰∫´ÊîªÁï•
                    </van-button>
                </div>

                <div class="strategy-list">
                    <div 
                        v-for="review in reviews" 
                        :key="review.id"
                        class="strategy-item"
                    >
                        <div class="review-header">
                            <img :src="review.avatar" alt="Â§¥ÂÉè" class="reviewer-avatar" />
                            <div class="reviewer-info">
                                <div class="reviewer-name">{{ review.username }}</div>
                                <div class="review-time">{{ formatTime(review.createdAt) }}</div>
                            </div>
                        </div>
                        <div class="review-content">{{ review.content }}</div>
                        <div v-if="review.images?.length" class="review-images">
                            <img 
                                v-for="(image, index) in review.images" 
                                :key="index"
                                :src="image" 
                                alt="ËØÑ‰ª∑ÂõæÁâá"
                                class="review-image"
                            />
                        </div>
                        <div class="review-actions">
                            <van-button 
                                type="default" 
                                size="mini" 
                                :icon="review.isLiked ? 'like' : 'like-o'"
                                @click="toggleReviewLike(review)"
                            >
                                {{ review.likes }}
                            </van-button>
                        </div>
                    </div>
                </div>

                <div v-if="reviews.length === 0" class="no-strategy">
                    <van-empty description="ÊöÇÊó†ÊîªÁï•">
                        <van-button 
                            type="primary" 
                            @click="showReviewDialog = true"
                        >
                            ÂàÜ‰∫´Á¨¨‰∏ÄÊù°ÊîªÁï•
                        </van-button>
                    </van-empty>
                </div>
            </div>
        </div>

        <!-- ÊîªÁï•ÂºπÁ™ó -->
        <van-popup v-model:show="showReviewDialog" position="bottom" :style="{ height: '70%' }">
            <div class="strategy-dialog">
                <div class="dialog-header">
                    <h3>ÂàÜ‰∫´ÊîªÁï•</h3>
                    <van-button type="primary" size="small" @click="submitReview">ÂèëÂ∏É</van-button>
                </div>
                
                <van-field
                    v-model="newReview.content"
                    type="textarea"
                    placeholder="ÂàÜ‰∫´‰Ω†ÁöÑÈíìÈ±ºÊîªÁï•ÂíåÊäÄÂ∑ß..."
                    rows="4"
                    maxlength="200"
                    show-word-limit
                />
                
                <div class="image-upload">
                    <van-uploader
                        v-model="newReview.images"
                        multiple
                        :max-count="3"
                        :after-read="afterRead"
                    />
                </div>
            </div>
        </van-popup>

        <div v-if="!loading && !spotInfo" class="error-container">
            <van-empty description="ÈíìÁÇπ‰ø°ÊÅØÂä†ËΩΩÂ§±Ë¥•" />
        </div>

        <!-- Â∫ïÈÉ®Êìç‰ΩúÊ†è -->
        <div v-if="spotInfo" class="bottom-actions">
            <van-button 
                :icon="isCollected ? 'star' : 'star-o'"
                :type="isCollected ? 'warning' : 'default'"
                size="large"
                class="action-btn collect-btn"
                @click="toggleCollect"
            >
                {{ isCollected ? 'Â∑≤Êî∂Ëóè' : 'Êî∂Ëóè' }}
            </van-button>
            <van-button 
                icon="guide-o"
                type="primary"
                size="large"
                class="action-btn navigate-btn"
                @click="navigateToSpot"
            >
                ÂØºËà™
            </van-button>
        </div>
    </div>
</template>

<script setup lang="ts">
import { ref, computed, onMounted } from 'vue';
import { useRouter, useRoute } from 'vue-router';
import { showToast } from 'vant';
import { FishingSpotType, type FishingSpot, type WeatherInfo, type Comment } from '../types/fishing';

const router = useRouter();
const route = useRoute();

// ÂìçÂ∫îÂºèÊï∞ÊçÆ
const loading = ref(true);
const spotInfo = ref<(FishingSpot & { 
    hydrologyInfo?: {
        updateTime: string;
        waterLevel: number;
        waterTemperature: number;
        waterQuality: string;
        waterClarity: number;
    };
}) | null>(null);
const showReviewDialog = ref(false);
const reviews = ref<(Comment & { avatar: string; username: string; images?: string[]; isLiked: boolean })[]>([]);
const newReview = ref({
    content: '',
    images: []
});
const isCollected = ref(false);
// Â§©Ê∞î‰ø°ÊÅØ
const weather = ref<WeatherInfo>({
    temperature: 22,
    humidity: 65,
    pressure: 1013,
    windSpeed: 3.2,
    windDirection: '‰∏úÂçóÈ£é',
    weather: 'Â§ö‰∫ë',
    suitabilityIndex: 8
});

// ËÆ°ÁÆóÂ±ûÊÄß
const spotId = computed(() => route.params.id as string);

// Ê®°ÊãüÊï∞ÊçÆ
const mockSpotData: Record<string, any> = {
    'spot_1': {
        id: 'spot_1',
        name: 'Áø†ÊπñÂÖ¨Âõ≠ÈíìÁÇπ',
        type: FishingSpotType.LAKE,
        latitude: 39.9042,
        longitude: 116.4074,
        address: 'Âåó‰∫¨Â∏ÇÊµ∑Ê∑ÄÂå∫Áø†ÊπñÂÖ¨Âõ≠ÂÜÖ',
        city: 'Âåó‰∫¨',
        description: 'Áø†ÊπñÂÖ¨Âõ≠ÈíìÁÇπ‰Ωç‰∫éÂåó‰∫¨Â∏ÇÊµ∑Ê∑ÄÂå∫ÔºåÊòØ‰∏Ä‰∏™ÁéØÂ¢É‰ºòÁæéÁöÑÂüéÂ∏ÇÊπñÊ≥äÈíìÁÇπ„ÄÇÊπñÊ∞¥Ê∏ÖÊæàÔºåÂë®Âõ¥ÁªøÊ†ëÊàêËç´ÔºåÁ©∫Ê∞îÊ∏ÖÊñ∞ÔºåÊòØ‰ºëÈó≤ÂûÇÈíìÁöÑÁªù‰Ω≥ÈÄâÊã©„ÄÇ',
        images: [
            'https://img.yzcdn.cn/vant/apple-1.jpg',
            'https://img.yzcdn.cn/vant/apple-2.jpg',
            'https://img.yzcdn.cn/vant/apple-3.jpg'
        ],
        rating: 4.5,
        reviewCount: 128,
        fishSpecies: ['È≤´È±º', 'ËçâÈ±º', 'È≤§È±º', 'ÁôΩÊù°'],
        createdBy: 'user_1',
        createdAt: new Date(),
        approved: true,
        currentPeople: 8,
        distance: 2.3,
        hydrologyInfo: {
            updateTime: '2023-10-26 10:00',
            waterLevel: 1.2,
            waterTemperature: 22,
            waterQuality: 'ËâØÂ•Ω',
            waterClarity: 60
        }
    },
    'spot_2': {
        id: 'spot_2',
        name: 'Â§©ÈπÖÊπñÈíìÁÇπ',
        type: FishingSpotType.RESERVOIR,
        latitude: 39.9142,
        longitude: 116.4174,
        address: 'Âåó‰∫¨Â∏ÇÊúùÈò≥Âå∫Â§©ÈπÖÊπñÂÖ¨Âõ≠',
        city: 'Âåó‰∫¨',
        description: 'Â§©ÈπÖÊπñÈíìÁÇπÁéØÂ¢É‰ºòÁæéÔºåÊ∞¥Ë¥®Ê∏ÖÊæàÔºåÊòØÂüéÂ∏Ç‰∏≠ÈöæÂæóÁöÑÂûÇÈíìËÉúÂú∞„ÄÇ',
        images: [
            'https://img.yzcdn.cn/vant/apple-4.jpg',
            'https://img.yzcdn.cn/vant/apple-5.jpg'
        ],
        rating: 4.3,
        reviewCount: 89,
        fishSpecies: ['È≤´È±º', 'È≤§È±º', 'È≤¢È±º'],
        createdBy: 'user_2',
        createdAt: new Date(),
        approved: true,
        currentPeople: 5,
        distance: 3.1,
        hydrologyInfo: {
            updateTime: '2023-10-26 11:30',
            waterLevel: 1.8,
            waterTemperature: 20,
            waterQuality: 'ËâØÂ•Ω',
            waterClarity: 70
        }
    }
};

// Ê®°ÊãüËØÑ‰ª∑Êï∞ÊçÆ
const mockReviews = [
    {
        id: 'review_1',
        userId: 'user_2',
        username: 'ÈíìÈ±ºËææ‰∫∫',
        avatar: 'https://img.yzcdn.cn/vant/cat.jpeg',
        content: 'Ëøô‰∏™ÈíìÁÇπÁúüÁöÑÂæà‰∏çÈîôÔºÅÁéØÂ¢É‰ºòÁæéÔºåÈ±ºÂÑø‰πüÂæàÊ¥ªË∑É„ÄÇ‰ªäÂ§©Áî®ÁéâÁ±≥Á≤íÈíì‰∫Ü3Êù°ËçâÈ±ºÔºåÊúÄÂ§ßÁöÑÊúâ2.5ÂÖ¨Êñ§„ÄÇÊé®ËçêÂ§ßÂÆ∂Êù•ËØïËØïÔºÅ',
        createdAt: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000),
        likes: 15,
        rating: 5,
        images: ['https://img.yzcdn.cn/vant/apple-1.jpg'],
        isLiked: false
    },
    {
        id: 'review_2',
        userId: 'user_3',
        username: 'ÊπñËæπËÄÅÁéã',
        avatar: 'https://img.yzcdn.cn/vant/cat.jpeg',
        content: 'ËÆæÊñΩÂæàÂÆåÂñÑÔºåÂÅúËΩ¶Êñπ‰æøÔºåÂ∞±ÊòØ‰∫∫ÊúâÁÇπÂ§ö„ÄÇÂª∫ËÆÆÊó©ÁÇπÊù•Âç†‰ΩçÁΩÆ„ÄÇ',
        createdAt: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000),
        likes: 8,
        rating: 4,
        isLiked: true
    }
];

// Â∑•ÂÖ∑ÂáΩÊï∞
const getSpotTypeText = (type: FishingSpotType): string => {
    const typeMap = {
        [FishingSpotType.FRESHWATER]: 'Ê∑°Ê∞¥',
        [FishingSpotType.SALTWATER]: 'Êµ∑Ê∞¥',
        [FishingSpotType.BLACK_PIT]: 'ÈªëÂùë',
        [FishingSpotType.RESERVOIR]: 'Ê∞¥Â∫ì',
        [FishingSpotType.RIVER]: 'Ê≤≥ÊµÅ',
        [FishingSpotType.LAKE]: 'ÊπñÊ≥ä'
    };
    return typeMap[type] || 'Êú™Áü•';
};

const getSuitabilityClass = (index: number): string => {
    if (index >= 8) return 'excellent';
    if (index >= 6) return 'good';
    if (index >= 4) return 'fair';
    return 'poor';
};

const formatTime = (date: Date): string => {
    const now = new Date();
    const diff = now.getTime() - date.getTime();
    const days = Math.floor(diff / (1000 * 60 * 60 * 24));
    
    if (days === 0) return '‰ªäÂ§©';
    if (days === 1) return 'Êò®Â§©';
    if (days < 7) return `${days}Â§©Ââç`;
    return date.toLocaleDateString();
};

const formatHydrologyTime = (time: string): string => {
    const date = new Date(time);
    return date.toLocaleDateString() + ' ' + date.toLocaleTimeString();
};

const getWaterQualityClass = (quality: string): string => {
    switch (quality) {
        case 'ËâØÂ•Ω':
            return 'good';
        case '‰∏ÄËà¨':
            return 'fair';
        case 'ËæÉÂ∑Æ':
            return 'poor';
        default:
            return '';
    }
};

const shareSpot = () => {
    showToast('ÂàÜ‰∫´ÂäüËÉΩÂºÄÂèë‰∏≠');
};



const goToWeatherDetail = () => {
    if (spotInfo.value) {
        router.push(`/spot/${spotInfo.value.id}/weather`);
    }
};

const goToWaterDetail = () => {
    if (spotInfo.value) {
        router.push(`/spot/${spotInfo.value.id}/water`);
    }
};

const refreshHydrology = () => {
    showToast('Ê∞¥Êñá‰ø°ÊÅØÂà∑Êñ∞ÂäüËÉΩÂºÄÂèë‰∏≠');
};

const toggleReviewLike = (review: any) => {
    review.isLiked = !review.isLiked;
    review.likes += review.isLiked ? 1 : -1;
    showToast(review.isLiked ? 'ÁÇπËµûÊàêÂäü' : 'ÂèñÊ∂àÁÇπËµû');
};

const afterRead = (file: any) => {
    console.log('‰∏ä‰º†Êñá‰ª∂:', file);
    showToast('ÂõæÁâá‰∏ä‰º†ÂäüËÉΩÂºÄÂèë‰∏≠');
};

// Êî∂ËóèÂäüËÉΩ
const toggleCollect = () => {
    isCollected.value = !isCollected.value;
    showToast(isCollected.value ? 'Êî∂ËóèÊàêÂäü' : 'ÂèñÊ∂àÊî∂Ëóè');
};

// ÂØºËà™ÂäüËÉΩ
const navigateToSpot = () => {
    if (spotInfo.value) {
        const { latitude, longitude } = spotInfo.value;
        // ‰ΩøÁî®È´òÂæ∑Âú∞ÂõæÂØºËà™
        const url = `https://uri.amap.com/navigation?to=${longitude},${latitude}&mode=car&policy=1&src=myapp&coordinate=gaode&callnative=0`;
        window.open(url, '_blank');
        showToast('Ê≠£Âú®ÊâìÂºÄÂØºËà™');
    }
};

const submitReview = () => {
    if (!newReview.value.content.trim()) {
        showToast('ËØ∑ËæìÂÖ•ËØÑ‰ª∑ÂÜÖÂÆπ');
        return;
    }
    
    const review = {
        id: `review_${Date.now()}`,
        userId: 'current_user',
        username: 'Êàë',
        avatar: 'https://img.yzcdn.cn/vant/cat.jpeg',
        content: newReview.value.content,
        createdAt: new Date(),
        likes: 0,
        rating: 5,
        images: [],
        isLiked: false
    };
    
    reviews.value.unshift(review);
    showReviewDialog.value = false;
    showToast('ËØÑ‰ª∑ÂèëÂ∏ÉÊàêÂäü');
    
    // ÈáçÁΩÆË°®Âçï
    newReview.value = {
        content: '',
        images: []
    };
};

// ÁîüÂëΩÂë®Êúü
onMounted(async () => {
    try {
        // Ê®°ÊãüAPIËØ∑Ê±Ç
        await new Promise(resolve => setTimeout(resolve, 1000));
        
        const spot = mockSpotData[spotId.value];
        if (spot) {
            spotInfo.value = spot;
            reviews.value = [...mockReviews];
        } else {
            showToast('ÈíìÁÇπ‰ø°ÊÅØÊú™ÊâæÂà∞');
        }
    } catch (error) {
        showToast('Âä†ËΩΩÂ§±Ë¥•');
    } finally {
        loading.value = false;
    }
});
</script>

<style scoped>
.spot-detail-page {
    min-height: 100vh;
    background: var(--van-background-color);
    padding-bottom: 80px;
}

.loading-container {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 50vh;
}

.spot-content {
    padding-bottom: 20px;
}

/* ÈíìÁÇπÂõæÁâáÂ±ïÁ§∫ */
.spot-images {
    position: relative;
    width: 100%;
    height: 200px;
    background: #f5f5f5;
    border-radius: 8px;
    overflow: hidden;
    margin-bottom: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.spot-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.no-image {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: var(--van-text-color-2);
    font-size: 14px;
}

.no-image .van-icon {
    margin-bottom: 8px;
}

/* Âü∫Êú¨‰ø°ÊÅØ */
.spot-basic-info {
    padding: 16px;
    background: white;
    margin-bottom: 12px;
}

.spot-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 12px;
}

.spot-name {
    font-size: 20px;
    font-weight: bold;
    color: var(--van-text-color);
    margin: 0;
    flex: 1;
}

.spot-type-badge {
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 12px;
    color: white;
}

.spot-type-badge.lake {
    background: linear-gradient(45deg, #42A5F5, #1E88E5);
}

.spot-type-badge.reservoir {
    background: linear-gradient(45deg, #66BB6A, #4CAF50);
}

.spot-type-badge.river {
    background: linear-gradient(45deg, #26C6DA, #00BCD4);
}

.spot-type-badge.black_pit {
    background: linear-gradient(45deg, #78909C, #607D8B);
}

.address-section {
    display: flex;
    align-items: center;
    gap: 8px;
    color: var(--van-text-color-2);
    font-size: 14px;
}

.address {
    flex: 1;
    margin-right: 8px;
}

/* È±ºÁßç‰ø°ÊÅØ */
.fish-species-section,
.description-section,
.weather-section,
.hydrology-section,
.strategy-section {
    background: white;
    margin-bottom: 8px;
    padding: 16px;
}

.fish-species-section h3,
.description-section h3,
.weather-section h3,
.hydrology-section h3,
.strategy-section h3 {
    margin: 0 0 12px 0;
    font-size: 18px;
    color: var(--van-text-color);
}

.fish-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}

.fish-tag {
    margin-bottom: 4px;
}

/* ÊèèËø∞ */
.description-text {
    line-height: 1.6;
    color: var(--van-text-color-2);
    margin: 0;
}

.error-container {
    padding: 50px 20px;
    text-align: center;
}

/* Â§©Ê∞î‰ø°ÊÅØ */
.weather-card {
    background: linear-gradient(135deg, #42A5F5, #1E88E5);
    color: white;
    border-radius: 12px;
    padding: 16px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.weather-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(66, 165, 245, 0.3);
}

.weather-main {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
}

.temperature {
    font-size: 28px;
    font-weight: bold;
}

.weather-desc {
    font-size: 14px;
    opacity: 0.9;
}

.weather-icon {
    font-size: 32px;
}

.weather-details {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
    margin-bottom: 16px;
}

.weather-item {
    display: flex;
    justify-content: space-between;
    font-size: 14px;
}

.weather-item .label {
    opacity: 0.8;
}

.suitability.excellent {
    color: #4CAF50;
    font-weight: bold;
}

.suitability.good {
    color: #FF9800;
    font-weight: bold;
}

.suitability.fair {
    color: #FFC107;
}

.suitability.poor {
    color: #F44336;
}

/* Ê∞¥Êñá‰ø°ÊÅØ */
.hydrology-card {
    background: linear-gradient(135deg, #42A5F5, #1E88E5);
    color: white;
    border-radius: 12px;
    padding: 16px;
    cursor: pointer;
    transition: all 0.3s ease;
}

.hydrology-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(66, 165, 245, 0.3);
}

.hydrology-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
}

.update-time {
    font-size: 12px;
    color: rgba(255, 255, 255, 0.8);
}

.hydrology-main {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
    margin-bottom: 12px;
}

.hydrology-item {
    display: flex;
    align-items: center;
    gap: 12px;
}

.hydrology-icon {
    font-size: 24px;
}

.hydrology-content {
    flex: 1;
}

.hydrology-label {
    font-size: 12px;
    color: rgba(255, 255, 255, 0.8);
    margin-bottom: 2px;
}

.hydrology-value {
    font-size: 16px;
    font-weight: 600;
    color: white;
}

.hydrology-value.good {
    color: #4CAF50;
}

.hydrology-value.fair {
    color: #FF9800;
}

.hydrology-value.poor {
    color: #F44336;
}

/* ÁÇπÂáªÊèêÁ§∫ */
.click-hint {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    margin-top: 12px;
    padding: 8px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    font-size: 12px;
    opacity: 0.8;
    transition: opacity 0.3s ease;
}

.weather-card:hover .click-hint,
.hydrology-card:hover .click-hint {
    opacity: 1;
}

/* ÈíìÁÇπÊîªÁï• */
.strategy-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
}

.strategy-list {
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.strategy-item {
    border: 1px solid var(--van-border-color);
    border-radius: 8px;
    padding: 12px;
}

.review-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 8px;
}

.reviewer-avatar {
    width: 36px;
    height: 36px;
    border-radius: 50%;
}

.reviewer-info {
    flex: 1;
}

.reviewer-name {
    font-size: 14px;
    font-weight: 600;
    color: var(--van-text-color);
}

.review-time {
    font-size: 12px;
    color: var(--van-text-color-3);
}

.review-content {
    line-height: 1.5;
    color: var(--van-text-color-2);
    margin-bottom: 8px;
}

.review-images {
    display: flex;
    gap: 8px;
    margin-bottom: 8px;
}

.review-image {
    width: 60px;
    height: 60px;
    border-radius: 6px;
    object-fit: cover;
    cursor: pointer;
}

.review-actions {
    display: flex;
    justify-content: flex-end;
}

/* ÊîªÁï•ÂºπÁ™ó */
.strategy-dialog {
    padding: 16px;
    height: 100%;
    display: flex;
    flex-direction: column;
}

.dialog-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;
}

.dialog-header h3 {
    margin: 0;
    color: var(--van-text-color);
}

.image-upload {
    margin-top: 16px;
}

/* Â∫ïÈÉ®Êìç‰ΩúÊ†è */
.bottom-actions {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: white;
    padding: 12px 16px;
    border-top: 1px solid var(--van-border-color);
    display: flex;
    gap: 12px;
    z-index: 100;
    box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
}

.action-btn {
    flex: 1;
    height: 44px;
    border-radius: 22px;
    font-weight: 600;
}

.collect-btn {
    background: var(--van-gray-1);
    border: 1px solid var(--van-border-color);
    color: var(--van-text-color);
}

.collect-btn.van-button--warning {
    background: #fff7e6;
    border-color: #ffa940;
    color: #fa8c16;
}

.navigate-btn {
    background: linear-gradient(135deg, #1890ff, #096dd9);
    border: none;
    color: white;
}

/* ‰∏∫Â∫ïÈÉ®Êìç‰ΩúÊ†èÈ¢ÑÁïôÁ©∫Èó¥ */
.spot-content {
    padding-bottom: 80px;
}
</style>