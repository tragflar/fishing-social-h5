import{l as e,r as t,c as a,f as s,L as i,k as l,R as c,Q as n,S as o,F as r,V as d,X as u,M as m,N as h,O as p,Y as v,W as g,B as w,A as f}from"./vendor-788d0564.js";import{c as _,a as y,b as k}from"./vant-7a9d22a8.js";import{_ as C}from"./_plugin-vue_export-helper-1b428a4d.js";const S={class:"record-page"},b={class:"record-content"},x={class:"stats-section"},D={class:"stats-card"},T={class:"stat-item"},N={class:"stat-value"},z={class:"stat-item"},I={class:"stat-value"},j={class:"stat-item"},V={class:"stat-value"},$={class:"stat-item"},q={class:"stat-value"},B={class:"filter-section"},P={class:"records-list"},A=["onClick"],L={class:"record-header"},U={class:"record-info"},F={class:"fish-name"},E={class:"record-time"},M={class:"record-weight"},R={key:0,class:"record-images"},O=["src","alt","onClick"],Q={key:0,class:"more-images"},W={class:"record-details"},X={class:"detail-item"},Y={class:"detail-item"},G={class:"detail-item"},H={key:0,class:"detail-item"},J={class:"record-tags"},K={class:"record-actions"},Z={key:0,class:"empty-state"},ee={class:"chart-section"},te={class:"chart-container"},ae={class:"chart-placeholder"},se={class:"chart-bars"},ie={class:"bar-value"},le={class:"bar-label"},ce=C(e({__name:"Record",setup(e){m();const C=t(3),ce=t("all"),ne=t("time_desc"),oe=t("all"),re=[{text:"全部类型",value:"all"},{text:"淡水鱼",value:"freshwater"},{text:"海水鱼",value:"saltwater"}],de=[{text:"时间倒序",value:"time_desc"},{text:"时间正序",value:"time_asc"},{text:"重量倒序",value:"weight_desc"},{text:"重量正序",value:"weight_asc"}],ue=[{text:"全部时间",value:"all"},{text:"最近一周",value:"week"},{text:"最近一月",value:"month"},{text:"最近三月",value:"quarter"}],me=t([]),he=[{id:"record_1",userId:"current_user",spotId:"spot_1",spotName:"翠湖公园钓点",fishCatches:[{fishSpecies:"草鱼",count:1,weight:2.5}],images:["https://img.yzcdn.cn/vant/apple-1.jpg","https://img.yzcdn.cn/vant/apple-2.jpg"],equipment:["4.5米钓竿","2号主线","1号子线"],bait:"玉米粒",duration:3.5,weather:{temperature:22,humidity:65,pressure:1013,windSpeed:3.2,windDirection:"东南风",weather:"多云",suitabilityIndex:8},notes:"今天天气不错，鱼口很好，用玉米粒钓到了一条不错的草鱼。",catchTime:new Date(Date.now()-864e5),createdAt:new Date(Date.now()-864e5),likes:23,comments:[],isPersonalBest:!0,isNewSpot:!1,isNewSpecies:!1},{id:"record_2",userId:"current_user",spotId:"spot_2",spotName:"野鸭湖水库",fishCatches:[{fishSpecies:"鲤鱼",count:1,weight:1.8},{fishSpecies:"鲫鱼",count:3,weight:.6}],images:["https://img.yzcdn.cn/vant/apple-3.jpg"],equipment:["5.4米钓竿","3号主线","2号子线"],bait:"蚯蚓",duration:4,weather:{temperature:18,humidity:70,pressure:1008,windSpeed:2.1,windDirection:"北风",weather:"阴天",suitabilityIndex:7},notes:"阴天钓鱼，鱼儿比较活跃。",catchTime:new Date(Date.now()-2592e5),createdAt:new Date(Date.now()-2592e5),likes:15,comments:[],isPersonalBest:!1,isNewSpot:!0,isNewSpecies:!1},{id:"record_3",userId:"current_user",spotId:"spot_1",spotName:"翠湖公园钓点",fishCatches:[{fishSpecies:"鲫鱼",count:2,weight:.8}],images:[],equipment:["3.6米钓竿","1号主线","0.8号子线"],bait:"红虫",duration:2,weather:{temperature:25,humidity:60,pressure:1015,windSpeed:1.5,windDirection:"微风",weather:"晴天",suitabilityIndex:9},notes:"晴天钓鲫鱼，收获不错。",catchTime:new Date(Date.now()-6048e5),createdAt:new Date(Date.now()-6048e5),likes:8,comments:[],isPersonalBest:!1,isNewSpot:!1,isNewSpecies:!0},{id:"record_4",userId:"current_user",spotId:"spot_2",spotName:"野鸭湖水库",fishCatches:[{fishSpecies:"黑鱼",count:1,weight:3.2}],images:["https://img.yzcdn.cn/vant/apple-4.jpg","https://img.yzcdn.cn/vant/apple-5.jpg","https://img.yzcdn.cn/vant/apple-1.jpg","https://img.yzcdn.cn/vant/apple-2.jpg"],equipment:["6.3米钓竿","4号主线","3号子线"],bait:"小鱼",duration:5,weather:{temperature:20,humidity:75,pressure:1010,windSpeed:4.2,windDirection:"东风",weather:"小雨",suitabilityIndex:6},notes:"雨天钓黑鱼，意外收获一条大家伙！",catchTime:new Date(Date.now()-1296e6),createdAt:new Date(Date.now()-1296e6),likes:32,comments:[],isPersonalBest:!0,isNewSpot:!1,isNewSpecies:!0}],pe=t([{month:"1月",count:5},{month:"2月",count:8},{month:"3月",count:12},{month:"4月",count:15},{month:"5月",count:18},{month:"6月",count:22}]),ve=a(()=>{let e=[...me.value];if("all"!==ce.value&&(e=e.filter(e=>{const t=["鲫鱼","草鱼","鲤鱼","黑鱼"],a=["带鱼","鲈鱼","石斑鱼"];return"freshwater"===ce.value?e.fishCatches.some(e=>t.includes(e.fishSpecies)):"saltwater"!==ce.value||e.fishCatches.some(e=>a.includes(e.fishSpecies))})),"all"!==oe.value){const t=new Date,a={week:6048e5,month:2592e6,quarter:7776e6}[oe.value];e=e.filter(e=>t.getTime()-e.catchTime.getTime()<=a)}return e.sort((e,t)=>{switch(ne.value){case"time_desc":return t.catchTime.getTime()-e.catchTime.getTime();case"time_asc":return e.catchTime.getTime()-t.catchTime.getTime();case"weight_desc":const a=e.fishCatches.reduce((e,t)=>e+t.weight,0);return t.fishCatches.reduce((e,t)=>e+t.weight,0)-a;case"weight_asc":return e.fishCatches.reduce((e,t)=>e+t.weight,0)-t.fishCatches.reduce((e,t)=>e+t.weight,0);default:return 0}}),e}),ge=a(()=>me.value.length),we=a(()=>me.value.reduce((e,t)=>e+t.fishCatches.reduce((e,t)=>e+t.weight,0),0).toFixed(1)),fe=a(()=>{const e=new Set;return me.value.forEach(t=>{t.fishCatches.forEach(t=>e.add(t.fishSpecies))}),e.size}),_e=a(()=>new Set(me.value.map(e=>e.spotId)).size),ye=e=>{const t=(new Date).getTime()-e.getTime(),a=Math.floor(t/864e5);return 0===a?"今天 "+e.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):1===a?"昨天 "+e.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):a<7?`${a}天前`:e.toLocaleDateString("zh-CN")};return s(()=>{me.value=[...he]}),(e,t)=>{const a=h("van-icon"),s=h("van-nav-bar"),m=h("van-dropdown-item"),he=h("van-dropdown-menu"),ke=h("van-tag"),Ce=h("van-button"),Se=h("van-empty"),be=h("van-tabbar-item"),xe=h("van-tabbar");return p(),i("div",S,[l(s,{title:"钓获记录",fixed:""},{right:c(()=>[l(a,{name:"plus",onClick:t[0]||(t[0]=t=>e.$router.push("/record/add"))})]),_:1}),n("div",b,[n("div",x,[n("div",D,[n("div",T,[n("div",N,o(ge.value),1),t[7]||(t[7]=n("div",{class:"stat-label"},"总钓获",-1))]),n("div",z,[n("div",I,o(we.value)+"kg",1),t[8]||(t[8]=n("div",{class:"stat-label"},"总重量",-1))]),n("div",j,[n("div",V,o(fe.value),1),t[9]||(t[9]=n("div",{class:"stat-label"},"鱼种数",-1))]),n("div",$,[n("div",q,o(_e.value),1),t[10]||(t[10]=n("div",{class:"stat-label"},"钓点数",-1))])])]),n("div",B,[l(he,null,{default:c(()=>[l(m,{modelValue:ce.value,"onUpdate:modelValue":t[1]||(t[1]=e=>ce.value=e),options:re,title:"类型"},null,8,["modelValue"]),l(m,{modelValue:ne.value,"onUpdate:modelValue":t[2]||(t[2]=e=>ne.value=e),options:de,title:"排序"},null,8,["modelValue"]),l(m,{modelValue:oe.value,"onUpdate:modelValue":t[3]||(t[3]=e=>oe.value=e),options:ue,title:"时间"},null,8,["modelValue"])]),_:1})]),n("div",P,[(p(!0),i(r,null,d(ve.value,e=>(p(),i("div",{key:e.id,class:"record-card",onClick:e=>{y("记录详情功能开发中")}},[n("div",L,[n("div",U,[n("div",F,o(e.fishCatches.map(e=>`${e.fishSpecies}(${e.count}尾)`).join("、")),1),n("div",E,o(ye(e.catchTime)),1)]),n("div",M,o(e.fishCatches.reduce((e,t)=>e+t.weight,0).toFixed(1))+"kg ",1)]),e.images.length>0?(p(),i("div",R,[(p(!0),i(r,null,d(e.images.slice(0,3),(t,a)=>(p(),i("img",{key:a,src:t,alt:`钓获图片${a+1}`,class:"record-image",onClick:v(t=>{return s=e.images,void _({images:s,startPosition:a});var s},["stop"])},null,8,O))),128)),e.images.length>3?(p(),i("div",Q," +"+o(e.images.length-3),1)):u("",!0)])):u("",!0),n("div",W,[n("div",X,[l(a,{name:"location-o"}),n("span",null,o(e.spotName),1)]),n("div",Y,[l(a,{name:"clock-o"}),n("span",null,o(e.duration)+"小时",1)]),n("div",G,[l(a,{name:"shopping-cart-o"}),n("span",null,o(e.bait),1)]),e.weather?(p(),i("div",H,[l(a,{name:"sun-o"}),n("span",null,o(e.weather.weather),1)])):u("",!0)]),n("div",J,[e.isPersonalBest?(p(),g(ke,{key:0,type:"danger"},{default:c(()=>[...t[11]||(t[11]=[w(" 个人最佳 ",-1)])]),_:1})):u("",!0),e.isNewSpot?(p(),g(ke,{key:1,type:"success"},{default:c(()=>[...t[12]||(t[12]=[w(" 新钓点 ",-1)])]),_:1})):u("",!0),e.isNewSpecies?(p(),g(ke,{key:2,type:"primary"},{default:c(()=>[...t[13]||(t[13]=[w(" 新鱼种 ",-1)])]),_:1})):u("",!0)]),n("div",K,[l(Ce,{type:"default",size:"small",icon:"share-o",onClick:v(t=>(e=>{const t=e.fishCatches.map(e=>e.fishSpecies).join("、");y(`分享${t}钓获记录`)})(e),["stop"])},{default:c(()=>[...t[14]||(t[14]=[w(" 分享 ",-1)])]),_:2},1032,["onClick"]),l(Ce,{type:"default",size:"small",icon:"edit",onClick:v(e=>{y("编辑记录功能开发中")},["stop"])},{default:c(()=>[...t[15]||(t[15]=[w(" 编辑 ",-1)])]),_:2},1032,["onClick"]),l(Ce,{type:"default",size:"small",icon:"delete-o",onClick:v(t=>(async e=>{try{await k({title:"确认删除",message:"确定要删除这条钓获记录吗？"});const t=me.value.findIndex(t=>t.id===e.id);t>-1&&(me.value.splice(t,1),y("删除成功"))}catch{}})(e),["stop"])},{default:c(()=>[...t[16]||(t[16]=[w(" 删除 ",-1)])]),_:2},1032,["onClick"])])],8,A))),128)),0===ve.value.length?(p(),i("div",Z,[l(Se,{description:"暂无钓获记录"},{default:c(()=>[l(Ce,{type:"primary",onClick:t[4]||(t[4]=t=>e.$router.push("/record/add"))},{default:c(()=>[...t[17]||(t[17]=[w(" 添加第一条记录 ",-1)])]),_:1})]),_:1})])):u("",!0)]),n("div",ee,[t[18]||(t[18]=n("h3",null,"月度钓获趋势",-1)),n("div",te,[n("div",ae,[n("div",se,[(p(!0),i(r,null,d(pe.value,(e,t)=>(p(),i("div",{key:t,class:"chart-bar",style:f({height:10*e.count+"px"})},[n("div",ie,o(e.count),1),n("div",le,o(e.month),1)],4))),128))])])])])]),l(xe,{modelValue:C.value,"onUpdate:modelValue":t[5]||(t[5]=e=>C.value=e),fixed:""},{default:c(()=>[l(be,{icon:"location-o",to:"/map"},{default:c(()=>[...t[19]||(t[19]=[w("地图",-1)])]),_:1}),l(be,{icon:"home-o",to:"/home"},{default:c(()=>[...t[20]||(t[20]=[w("首页",-1)])]),_:1}),l(be,{icon:"trophy-o",to:"/ranking"},{default:c(()=>[...t[21]||(t[21]=[w("排行",-1)])]),_:1}),l(be,{icon:"user-o",to:"/profile"},{default:c(()=>[...t[22]||(t[22]=[w("我的",-1)])]),_:1})]),_:1},8,["modelValue"]),n("button",{class:"fab-button",onClick:t[6]||(t[6]=t=>e.$router.push("/record/add"))},[l(a,{name:"plus"})])])}}}),[["__scopeId","data-v-37e1f5fa"]]);export{ce as default};
