import{l as e,r as a,c as l,f as s,L as t,k as i,R as n,Q as o,W as r,S as d,y as c,F as v,V as u,Y as p,X as y,M as g,Z as m,N as h,O as w,B as f}from"./vendor-788d0564.js";import{F as k}from"./fishing-a433fcef.js";import{a as _}from"./vant-7a9d22a8.js";import{_ as b}from"./_plugin-vue_export-helper-1b428a4d.js";const C={class:"spot-detail-page"},I={key:0,class:"loading-container"},L={key:1,class:"spot-content"},z={class:"spot-images"},j=["src","alt"],D={key:1,class:"no-image"},S={class:"spot-basic-info"},T={class:"spot-header"},A={class:"spot-name"},R={class:"address-section"},x={class:"address"},E={class:"fish-species-section"},V={class:"fish-tags"},$={class:"description-section"},P={class:"description-text"},Q={class:"weather-section"},B={class:"weather-main"},F={class:"weather-left"},K={class:"temperature"},O={class:"weather-desc"},U={class:"weather-details"},W={class:"weather-item"},M={class:"value"},H={class:"weather-item"},N={class:"value"},X={class:"weather-item"},Y={class:"value"},Z={class:"weather-item"},q={class:"click-hint"},G={key:0,class:"hydrology-section"},J={class:"hydrology-header"},ee={class:"update-time"},ae={class:"hydrology-main"},le={class:"hydrology-item"},se={class:"hydrology-content"},te={class:"hydrology-value"},ie={class:"hydrology-item"},ne={class:"hydrology-content"},oe={class:"hydrology-value"},re={class:"hydrology-item"},de={class:"hydrology-content"},ce={class:"hydrology-item"},ve={class:"hydrology-content"},ue={class:"hydrology-value"},pe={class:"click-hint"},ye={class:"strategy-section"},ge={class:"strategy-header"},me={class:"strategy-list"},he={class:"review-header"},we=["src"],fe={class:"reviewer-info"},ke={class:"reviewer-name"},_e={class:"review-time"},be={class:"review-content"},Ce={key:0,class:"review-images"},Ie=["src"],Le={class:"review-actions"},ze={key:0,class:"no-strategy"},je={class:"strategy-dialog"},De={class:"dialog-header"},Se={class:"image-upload"},Te={key:2,class:"error-container"},Ae={key:3,class:"bottom-actions"},Re=b(e({__name:"SpotDetail",setup(e){const b=g(),Re=m(),xe=a(!0),Ee=a(null),Ve=a(!1),$e=a([]),Pe=a({content:"",images:[]}),Qe=a(!1),Be=a({temperature:22,humidity:65,pressure:1013,windSpeed:3.2,windDirection:"ä¸œå—é£Ž",weather:"å¤šäº‘",suitabilityIndex:8}),Fe=l(()=>Re.params.id),Ke={spot_1:{id:"spot_1",name:"ç¿ æ¹–å…¬å›­é’“ç‚¹",type:k.LAKE,latitude:39.9042,longitude:116.4074,address:"åŒ—äº¬å¸‚æµ·æ·€åŒºç¿ æ¹–å…¬å›­å†…",city:"åŒ—äº¬",description:"ç¿ æ¹–å…¬å›­é’“ç‚¹ä½äºŽåŒ—äº¬å¸‚æµ·æ·€åŒºï¼Œæ˜¯ä¸€ä¸ªçŽ¯å¢ƒä¼˜ç¾Žçš„åŸŽå¸‚æ¹–æ³Šé’“ç‚¹ã€‚æ¹–æ°´æ¸…æ¾ˆï¼Œå‘¨å›´ç»¿æ ‘æˆè«ï¼Œç©ºæ°”æ¸…æ–°ï¼Œæ˜¯ä¼‘é—²åž‚é’“çš„ç»ä½³é€‰æ‹©ã€‚",images:["https://img.yzcdn.cn/vant/apple-1.jpg","https://img.yzcdn.cn/vant/apple-2.jpg","https://img.yzcdn.cn/vant/apple-3.jpg"],rating:4.5,reviewCount:128,fishSpecies:["é²«é±¼","è‰é±¼","é²¤é±¼","ç™½æ¡"],createdBy:"user_1",createdAt:new Date,approved:!0,currentPeople:8,distance:2.3,hydrologyInfo:{updateTime:"2023-10-26 10:00",waterLevel:1.2,waterTemperature:22,waterQuality:"è‰¯å¥½",waterClarity:60}},spot_2:{id:"spot_2",name:"å¤©é¹…æ¹–é’“ç‚¹",type:k.RESERVOIR,latitude:39.9142,longitude:116.4174,address:"åŒ—äº¬å¸‚æœé˜³åŒºå¤©é¹…æ¹–å…¬å›­",city:"åŒ—äº¬",description:"å¤©é¹…æ¹–é’“ç‚¹çŽ¯å¢ƒä¼˜ç¾Žï¼Œæ°´è´¨æ¸…æ¾ˆï¼Œæ˜¯åŸŽå¸‚ä¸­éš¾å¾—çš„åž‚é’“èƒœåœ°ã€‚",images:["https://img.yzcdn.cn/vant/apple-4.jpg","https://img.yzcdn.cn/vant/apple-5.jpg"],rating:4.3,reviewCount:89,fishSpecies:["é²«é±¼","é²¤é±¼","é²¢é±¼"],createdBy:"user_2",createdAt:new Date,approved:!0,currentPeople:5,distance:3.1,hydrologyInfo:{updateTime:"2023-10-26 11:30",waterLevel:1.8,waterTemperature:20,waterQuality:"è‰¯å¥½",waterClarity:70}}},Oe=[{id:"review_1",userId:"user_2",username:"é’“é±¼è¾¾äºº",avatar:"https://img.yzcdn.cn/vant/cat.jpeg",content:"è¿™ä¸ªé’“ç‚¹çœŸçš„å¾ˆä¸é”™ï¼çŽ¯å¢ƒä¼˜ç¾Žï¼Œé±¼å„¿ä¹Ÿå¾ˆæ´»è·ƒã€‚ä»Šå¤©ç”¨çŽ‰ç±³ç²’é’“äº†3æ¡è‰é±¼ï¼Œæœ€å¤§çš„æœ‰2.5å…¬æ–¤ã€‚æŽ¨èå¤§å®¶æ¥è¯•è¯•ï¼",createdAt:new Date(Date.now()-1728e5),likes:15,rating:5,images:["https://img.yzcdn.cn/vant/apple-1.jpg"],isLiked:!1},{id:"review_2",userId:"user_3",username:"æ¹–è¾¹è€çŽ‹",avatar:"https://img.yzcdn.cn/vant/cat.jpeg",content:"è®¾æ–½å¾ˆå®Œå–„ï¼Œåœè½¦æ–¹ä¾¿ï¼Œå°±æ˜¯äººæœ‰ç‚¹å¤šã€‚å»ºè®®æ—©ç‚¹æ¥å ä½ç½®ã€‚",createdAt:new Date(Date.now()-432e6),likes:8,rating:4,isLiked:!0}],Ue=e=>{const a=(new Date).getTime()-e.getTime(),l=Math.floor(a/864e5);return 0===l?"ä»Šå¤©":1===l?"æ˜¨å¤©":l<7?`${l}å¤©å‰`:e.toLocaleDateString()},We=e=>{const a=new Date(e);return a.toLocaleDateString()+" "+a.toLocaleTimeString()},Me=e=>{switch(e){case"è‰¯å¥½":return"good";case"ä¸€èˆ¬":return"fair";case"è¾ƒå·®":return"poor";default:return""}},He=()=>{_("åˆ†äº«åŠŸèƒ½å¼€å‘ä¸­")},Ne=()=>{Ee.value&&b.push(`/spot/${Ee.value.id}/weather`)},Xe=()=>{Ee.value&&b.push(`/spot/${Ee.value.id}/water`)},Ye=()=>{_("æ°´æ–‡ä¿¡æ¯åˆ·æ–°åŠŸèƒ½å¼€å‘ä¸­")},Ze=e=>{console.log("ä¸Šä¼ æ–‡ä»¶:",e),_("å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½å¼€å‘ä¸­")},qe=()=>{Qe.value=!Qe.value,_(Qe.value?"æ”¶è—æˆåŠŸ":"å–æ¶ˆæ”¶è—")},Ge=()=>{if(Ee.value){const{latitude:e,longitude:a}=Ee.value,l=`https://uri.amap.com/navigation?to=${a},${e}&mode=car&policy=1&src=myapp&coordinate=gaode&callnative=0`;window.open(l,"_blank"),_("æ­£åœ¨æ‰“å¼€å¯¼èˆª")}},Je=()=>{if(!Pe.value.content.trim())return void _("è¯·è¾“å…¥è¯„ä»·å†…å®¹");const e={id:`review_${Date.now()}`,userId:"current_user",username:"æˆ‘",avatar:"https://img.yzcdn.cn/vant/cat.jpeg",content:Pe.value.content,createdAt:new Date,likes:0,rating:5,images:[],isLiked:!1};$e.value.unshift(e),Ve.value=!1,_("è¯„ä»·å‘å¸ƒæˆåŠŸ"),Pe.value={content:"",images:[]}};return s(async()=>{try{await new Promise(e=>setTimeout(e,1e3));const e=Ke[Fe.value];e?(Ee.value=e,$e.value=[...Oe]):_("é’“ç‚¹ä¿¡æ¯æœªæ‰¾åˆ°")}catch(e){_("åŠ è½½å¤±è´¥")}finally{xe.value=!1}}),(e,a)=>{var l;const s=h("van-icon"),g=h("van-nav-bar"),m=h("van-loading"),b=h("van-swipe-item"),Re=h("van-swipe"),Fe=h("van-button"),Ke=h("van-tag"),Oe=h("van-empty"),ea=h("van-field"),aa=h("van-uploader"),la=h("van-popup");return w(),t("div",C,[i(g,{title:(null==(l=Ee.value)?void 0:l.name)||"é’“ç‚¹è¯¦æƒ…","left-arrow":"",onClickLeft:a[0]||(a[0]=a=>e.$router.back())},{right:n(()=>[i(s,{name:"share-o",onClick:He})]),_:1},8,["title"]),xe.value?(w(),t("div",I,[i(m,{size:"24px",vertical:""},{default:n(()=>[...a[6]||(a[6]=[f("åŠ è½½ä¸­...",-1)])]),_:1})])):Ee.value?(w(),t("div",L,[o("div",z,[Ee.value.images&&Ee.value.images.length>0?(w(),r(Re,{key:0,autoplay:3e3,"indicator-color":"white"},{default:n(()=>[(w(!0),t(v,null,u(Ee.value.images,(e,a)=>(w(),r(b,{key:a},{default:n(()=>[o("img",{src:e,alt:`${Ee.value.name} å›¾ç‰‡${a+1}`,class:"spot-image"},null,8,j)]),_:2},1024))),128))]),_:1})):(w(),t("div",D,[i(s,{name:"photo-o",size:"48"}),a[7]||(a[7]=o("p",null,"æš‚æ— å›¾ç‰‡",-1))]))]),o("div",S,[o("div",T,[o("h1",A,d(Ee.value.name),1),o("div",{class:c(["spot-type-badge",Ee.value.type])},d((ta=Ee.value.type,{[k.FRESHWATER]:"æ·¡æ°´",[k.SALTWATER]:"æµ·æ°´",[k.BLACK_PIT]:"é»‘å‘",[k.RESERVOIR]:"æ°´åº“",[k.RIVER]:"æ²³æµ",[k.LAKE]:"æ¹–æ³Š"}[ta]||"æœªçŸ¥")),3)]),o("div",R,[i(s,{name:"location-o"}),o("span",x,d(Ee.value.address),1),i(Fe,{type:"primary",size:"small",onClick:Ge},{default:n(()=>[...a[8]||(a[8]=[f(" å¯¼èˆª ",-1)])]),_:1})])]),o("div",E,[a[9]||(a[9]=o("h3",null,"å¯é’“é±¼ç§",-1)),o("div",V,[(w(!0),t(v,null,u(Ee.value.fishSpecies,e=>(w(),r(Ke,{key:e,type:"primary",plain:"",class:"fish-tag"},{default:n(()=>[f(" ðŸŸ "+d(e),1)]),_:2},1024))),128))])]),o("div",$,[a[10]||(a[10]=o("h3",null,"é’“ç‚¹ä»‹ç»",-1)),o("p",P,d(Ee.value.description),1)]),o("div",Q,[a[17]||(a[17]=o("h3",null,"å¤©æ°”ä¿¡æ¯",-1)),o("div",{class:"weather-card",onClick:Ne},[o("div",B,[o("div",F,[o("div",K,d(Be.value.temperature)+"Â°C",1),o("div",O,d(Be.value.weather),1)]),a[11]||(a[11]=o("div",{class:"weather-right"},[o("div",{class:"weather-icon"},"ðŸŒ¤ï¸")],-1))]),o("div",U,[o("div",W,[a[12]||(a[12]=o("span",{class:"label"},"æ¹¿åº¦",-1)),o("span",M,d(Be.value.humidity)+"%",1)]),o("div",H,[a[13]||(a[13]=o("span",{class:"label"},"æ°”åŽ‹",-1)),o("span",N,d(Be.value.pressure)+"hPa",1)]),o("div",X,[a[14]||(a[14]=o("span",{class:"label"},"é£Žé€Ÿ",-1)),o("span",Y,d(Be.value.windSpeed)+"m/s",1)]),o("div",Z,[a[15]||(a[15]=o("span",{class:"label"},"é€‚é’“æŒ‡æ•°",-1)),o("span",{class:c(["value suitability",(sa=Be.value.suitabilityIndex,sa>=8?"excellent":sa>=6?"good":sa>=4?"fair":"poor")])},d(Be.value.suitabilityIndex)+"/10 ",3)])]),o("div",q,[i(s,{name:"arrow"}),a[16]||(a[16]=o("span",null,"ç‚¹å‡»æŸ¥çœ‹è¯¦ç»†å¤©æ°”ä¿¡æ¯",-1))])])]),Ee.value.hydrologyInfo?(w(),t("div",G,[a[28]||(a[28]=o("h3",null,"æ°´æ–‡ä¿¡æ¯",-1)),o("div",{class:"hydrology-card",onClick:Xe},[o("div",J,[o("div",ee," æ›´æ–°æ—¶é—´ï¼š"+d(We(Ee.value.hydrologyInfo.updateTime)),1),i(Fe,{type:"primary",size:"small",onClick:p(Ye,["stop"])},{default:n(()=>[...a[18]||(a[18]=[f(" åˆ·æ–° ",-1)])]),_:1})]),o("div",ae,[o("div",le,[a[20]||(a[20]=o("div",{class:"hydrology-icon"},"ðŸŒŠ",-1)),o("div",se,[a[19]||(a[19]=o("div",{class:"hydrology-label"},"æ°´ä½",-1)),o("div",te,d(Ee.value.hydrologyInfo.waterLevel)+"ç±³",1)])]),o("div",ie,[a[22]||(a[22]=o("div",{class:"hydrology-icon"},"ðŸŒ¡ï¸",-1)),o("div",ne,[a[21]||(a[21]=o("div",{class:"hydrology-label"},"æ°´æ¸©",-1)),o("div",oe,d(Ee.value.hydrologyInfo.waterTemperature)+"Â°C",1)])]),o("div",re,[a[24]||(a[24]=o("div",{class:"hydrology-icon"},"ðŸ’§",-1)),o("div",de,[a[23]||(a[23]=o("div",{class:"hydrology-label"},"æ°´è´¨",-1)),o("div",{class:c(["hydrology-value",Me(Ee.value.hydrologyInfo.waterQuality)])},d(Ee.value.hydrologyInfo.waterQuality),3)])]),o("div",ce,[a[26]||(a[26]=o("div",{class:"hydrology-icon"},"ðŸ‘ï¸",-1)),o("div",ve,[a[25]||(a[25]=o("div",{class:"hydrology-label"},"é€æ˜Žåº¦",-1)),o("div",ue,d(Ee.value.hydrologyInfo.waterClarity)+"cm",1)])])]),o("div",pe,[i(s,{name:"arrow"}),a[27]||(a[27]=o("span",null,"ç‚¹å‡»æŸ¥çœ‹è¯¦ç»†æ°´æ–‡ä¿¡æ¯",-1))])])])):y("",!0),o("div",ye,[o("div",ge,[o("h3",null,"é’“ç‚¹æ”»ç•¥ ("+d($e.value.length)+")",1),i(Fe,{type:"primary",size:"small",onClick:a[1]||(a[1]=e=>Ve.value=!0)},{default:n(()=>[...a[29]||(a[29]=[f(" åˆ†äº«æ”»ç•¥ ",-1)])]),_:1})]),o("div",me,[(w(!0),t(v,null,u($e.value,e=>{var a;return w(),t("div",{key:e.id,class:"strategy-item"},[o("div",he,[o("img",{src:e.avatar,alt:"å¤´åƒ",class:"reviewer-avatar"},null,8,we),o("div",fe,[o("div",ke,d(e.username),1),o("div",_e,d(Ue(e.createdAt)),1)])]),o("div",be,d(e.content),1),(null==(a=e.images)?void 0:a.length)?(w(),t("div",Ce,[(w(!0),t(v,null,u(e.images,(e,a)=>(w(),t("img",{key:a,src:e,alt:"è¯„ä»·å›¾ç‰‡",class:"review-image"},null,8,Ie))),128))])):y("",!0),o("div",Le,[i(Fe,{type:"default",size:"mini",icon:e.isLiked?"like":"like-o",onClick:a=>(e=>{e.isLiked=!e.isLiked,e.likes+=e.isLiked?1:-1,_(e.isLiked?"ç‚¹èµžæˆåŠŸ":"å–æ¶ˆç‚¹èµž")})(e)},{default:n(()=>[f(d(e.likes),1)]),_:2},1032,["icon","onClick"])])])}),128))]),0===$e.value.length?(w(),t("div",ze,[i(Oe,{description:"æš‚æ— æ”»ç•¥"},{default:n(()=>[i(Fe,{type:"primary",onClick:a[2]||(a[2]=e=>Ve.value=!0)},{default:n(()=>[...a[30]||(a[30]=[f(" åˆ†äº«ç¬¬ä¸€æ¡æ”»ç•¥ ",-1)])]),_:1})]),_:1})])):y("",!0)])])):y("",!0),i(la,{show:Ve.value,"onUpdate:show":a[5]||(a[5]=e=>Ve.value=e),position:"bottom",style:{height:"70%"}},{default:n(()=>[o("div",je,[o("div",De,[a[32]||(a[32]=o("h3",null,"åˆ†äº«æ”»ç•¥",-1)),i(Fe,{type:"primary",size:"small",onClick:Je},{default:n(()=>[...a[31]||(a[31]=[f("å‘å¸ƒ",-1)])]),_:1})]),i(ea,{modelValue:Pe.value.content,"onUpdate:modelValue":a[3]||(a[3]=e=>Pe.value.content=e),type:"textarea",placeholder:"åˆ†äº«ä½ çš„é’“é±¼æ”»ç•¥å’ŒæŠ€å·§...",rows:"4",maxlength:"200","show-word-limit":""},null,8,["modelValue"]),o("div",Se,[i(aa,{modelValue:Pe.value.images,"onUpdate:modelValue":a[4]||(a[4]=e=>Pe.value.images=e),multiple:"","max-count":3,"after-read":Ze},null,8,["modelValue"])])])]),_:1},8,["show"]),xe.value||Ee.value?y("",!0):(w(),t("div",Te,[i(Oe,{description:"é’“ç‚¹ä¿¡æ¯åŠ è½½å¤±è´¥"})])),Ee.value?(w(),t("div",Ae,[i(Fe,{icon:Qe.value?"star":"star-o",type:Qe.value?"warning":"default",size:"large",class:"action-btn collect-btn",onClick:qe},{default:n(()=>[f(d(Qe.value?"å·²æ”¶è—":"æ”¶è—"),1)]),_:1},8,["icon","type"]),i(Fe,{icon:"guide-o",type:"primary",size:"large",class:"action-btn navigate-btn",onClick:Ge},{default:n(()=>[...a[33]||(a[33]=[f(" å¯¼èˆª ",-1)])]),_:1})])):y("",!0)]);var sa,ta}}}),[["__scopeId","data-v-40c38e72"]]);export{Re as default};
