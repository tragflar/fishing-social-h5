import{l as X,r as k,c as h,f as Y,L as c,k as o,R as r,Q as t,S as n,F as I,V,X as p,M as G,N as _,O as l,B as m,Y as S,W as T}from"./vendor-38d0e5c9.js";import{c as H,a as C,b as J}from"./vant-d7f3bedd.js";import{_ as K}from"./_plugin-vue_export-helper-c27b6911.js";const Z={class:"my-records-page"},ee={class:"stats-card"},te={class:"stats-grid"},se={class:"stat-item"},ie={class:"stat-value"},ae={class:"stat-item"},oe={class:"stat-value"},ne={class:"stat-item"},le={class:"stat-value"},re={class:"stat-item"},de={class:"stat-value"},ce={class:"filter-section"},ue={class:"records-list"},me=["onClick"],pe={class:"record-header"},_e={class:"record-info"},ve={class:"fish-name"},we={class:"record-time"},ge={class:"record-weight"},he={key:0,class:"record-images"},fe=["src","alt","onClick"],ye={key:0,class:"more-images"},ke={class:"record-details"},Se={class:"detail-item"},Ce={class:"detail-item"},De={class:"detail-item"},Ne={key:0,class:"detail-item"},xe={class:"record-tags"},Te={class:"record-actions"},be={key:0,class:"empty-state"},Ie=X({__name:"MyRecords",setup(Ve){G();const v=k("all"),D=k("time_desc"),f=k("all"),$=[{text:"全部类型",value:"all"},{text:"淡水鱼",value:"freshwater"},{text:"海水鱼",value:"saltwater"}],z=[{text:"时间倒序",value:"time_desc"},{text:"时间正序",value:"time_asc"},{text:"重量倒序",value:"weight_desc"},{text:"重量正序",value:"weight_asc"}],R=[{text:"全部时间",value:"all"},{text:"最近一周",value:"week"},{text:"最近一月",value:"month"},{text:"最近三月",value:"quarter"}],u=k([]),B=[{id:"record_1",userId:"current_user",spotId:"spot_1",spotName:"翠湖公园钓点",fishSpecies:"草鱼",weight:2.5,length:45,images:["https://img.yzcdn.cn/vant/apple-1.jpg","https://img.yzcdn.cn/vant/apple-2.jpg"],equipment:["4.5米钓竿","2号主线","1号子线"],bait:"玉米粒",duration:3.5,weather:{temperature:22,humidity:65,pressure:1013,windSpeed:3.2,windDirection:"东南风",weather:"多云",suitabilityIndex:8},notes:"今天天气不错，鱼口很好，用玉米粒钓到了一条不错的草鱼。",catchTime:new Date(Date.now()-1*24*60*60*1e3),createdAt:new Date(Date.now()-1*24*60*60*1e3),likes:23,comments:[],isPersonalBest:!0,isNewSpot:!1,isNewSpecies:!1,description:"今天天气不错，鱼口很好，用玉米粒钓到了一条不错的草鱼。"},{id:"record_2",userId:"current_user",spotId:"spot_2",spotName:"野鸭湖水库",fishSpecies:"鲤鱼",weight:1.8,length:38,images:["https://img.yzcdn.cn/vant/apple-3.jpg"],equipment:["5.4米钓竿","3号主线","2号子线"],bait:"蚯蚓",duration:4,weather:{temperature:18,humidity:70,pressure:1008,windSpeed:2.1,windDirection:"北风",weather:"阴天",suitabilityIndex:7},notes:"阴天钓鱼，鱼儿比较活跃。",catchTime:new Date(Date.now()-3*24*60*60*1e3),createdAt:new Date(Date.now()-3*24*60*60*1e3),likes:15,comments:[],isPersonalBest:!1,isNewSpot:!0,isNewSpecies:!1,description:"阴天钓鱼，鱼儿比较活跃。"},{id:"record_3",userId:"current_user",spotId:"spot_1",spotName:"翠湖公园钓点",fishSpecies:"鲫鱼",weight:.8,length:25,images:[],equipment:["3.6米钓竿","1号主线","0.8号子线"],bait:"红虫",duration:2,weather:{temperature:25,humidity:60,pressure:1015,windSpeed:1.5,windDirection:"微风",weather:"晴天",suitabilityIndex:9},notes:"晴天钓鲫鱼，收获不错。",catchTime:new Date(Date.now()-7*24*60*60*1e3),createdAt:new Date(Date.now()-7*24*60*60*1e3),likes:8,comments:[],isPersonalBest:!1,isNewSpot:!1,isNewSpecies:!0,description:"晴天钓鲫鱼，收获不错。"}],b=h(()=>{let s=[...u.value];if(v.value!=="all"&&(s=s.filter(e=>{const a=["鲫鱼","草鱼","鲤鱼","黑鱼"],d=["带鱼","鲈鱼","石斑鱼"];return v.value==="freshwater"?a.includes(e.fishSpecies):v.value==="saltwater"?d.includes(e.fishSpecies):!0})),f.value!=="all"){const e=new Date,d={week:7*24*60*60*1e3,month:30*24*60*60*1e3,quarter:90*24*60*60*1e3}[f.value];s=s.filter(w=>e.getTime()-w.createdAt.getTime()<=d)}return s.sort((e,a)=>{switch(D.value){case"time_desc":return a.createdAt.getTime()-e.createdAt.getTime();case"time_asc":return e.createdAt.getTime()-a.createdAt.getTime();case"weight_desc":return a.weight-e.weight;case"weight_asc":return e.weight-a.weight;default:return 0}}),s}),A=h(()=>u.value.length),L=h(()=>u.value.reduce((s,e)=>s+e.weight,0).toFixed(1)),q=h(()=>new Set(u.value.map(s=>s.fishSpecies)).size),M=h(()=>new Set(u.value.map(s=>s.spotId)).size),P=s=>{const a=new Date().getTime()-s.getTime(),d=Math.floor(a/(1e3*60*60*24));return d===0?"今天 "+s.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):d===1?"昨天 "+s.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"}):d<7?`${d}天前`:s.toLocaleDateString("zh-CN")},F=(s,e)=>{H({images:s,startPosition:e})},O=s=>{C("记录详情功能开发中")},j=s=>{C(`分享${s.fishSpecies}钓获记录`)},U=s=>{C("编辑记录功能开发中")},W=async s=>{try{await J({title:"确认删除",message:"确定要删除这条钓获记录吗？"});const e=u.value.findIndex(a=>a.id===s.id);e>-1&&(u.value.splice(e,1),C("删除成功"))}catch{}};return Y(()=>{u.value=B}),(s,e)=>{const a=_("van-button"),d=_("van-nav-bar"),w=_("van-dropdown-item"),E=_("van-dropdown-menu"),y=_("van-icon"),N=_("van-tag"),Q=_("van-empty");return l(),c("div",Z,[o(d,{title:"我的钓获","left-arrow":"",onClickLeft:e[1]||(e[1]=i=>s.$router.back())},{right:r(()=>[o(a,{size:"small",type:"primary",onClick:e[0]||(e[0]=i=>s.$router.push("/record/add"))},{default:r(()=>e[6]||(e[6]=[m(" 添加记录 ",-1)])),_:1,__:[6]})]),_:1}),t("div",ee,[t("div",te,[t("div",se,[t("div",ie,n(A.value),1),e[7]||(e[7]=t("div",{class:"stat-label"},"总钓获",-1))]),t("div",ae,[t("div",oe,n(L.value)+"kg",1),e[8]||(e[8]=t("div",{class:"stat-label"},"总重量",-1))]),t("div",ne,[t("div",le,n(q.value),1),e[9]||(e[9]=t("div",{class:"stat-label"},"鱼种数",-1))]),t("div",re,[t("div",de,n(M.value),1),e[10]||(e[10]=t("div",{class:"stat-label"},"钓点数",-1))])])]),t("div",ce,[o(E,null,{default:r(()=>[o(w,{modelValue:v.value,"onUpdate:modelValue":e[2]||(e[2]=i=>v.value=i),options:$,title:"类型"},null,8,["modelValue"]),o(w,{modelValue:D.value,"onUpdate:modelValue":e[3]||(e[3]=i=>D.value=i),options:z,title:"排序"},null,8,["modelValue"]),o(w,{modelValue:f.value,"onUpdate:modelValue":e[4]||(e[4]=i=>f.value=i),options:R,title:"时间"},null,8,["modelValue"])]),_:1})]),t("div",ue,[(l(!0),c(I,null,V(b.value,i=>(l(),c("div",{key:i.id,class:"record-card",onClick:g=>O()},[t("div",pe,[t("div",_e,[t("div",ve,n(i.fishSpecies),1),t("div",we,n(P(i.createdAt)),1)]),t("div",ge,n(i.weight)+"kg",1)]),i.images.length>0?(l(),c("div",he,[(l(!0),c(I,null,V(i.images.slice(0,3),(g,x)=>(l(),c("img",{key:x,src:g,alt:`钓获图片${x+1}`,class:"record-image",onClick:S($e=>F(i.images,x),["stop"])},null,8,fe))),128)),i.images.length>3?(l(),c("div",ye," +"+n(i.images.length-3),1)):p("",!0)])):p("",!0),t("div",ke,[t("div",Se,[o(y,{name:"location-o"}),t("span",null,n(i.spotName),1)]),t("div",Ce,[o(y,{name:"clock-o"}),t("span",null,n(i.duration)+"小时",1)]),t("div",De,[o(y,{name:"shopping-cart-o"}),t("span",null,n(i.bait),1)]),i.weather?(l(),c("div",Ne,[o(y,{name:"sun-o"}),t("span",null,n(i.weather.weather),1)])):p("",!0)]),t("div",xe,[i.isPersonalBest?(l(),T(N,{key:0,type:"danger"},{default:r(()=>e[11]||(e[11]=[m(" 个人最佳 ",-1)])),_:1,__:[11]})):p("",!0),i.isNewSpot?(l(),T(N,{key:1,type:"success"},{default:r(()=>e[12]||(e[12]=[m(" 新钓点 ",-1)])),_:1,__:[12]})):p("",!0),i.isNewSpecies?(l(),T(N,{key:2,type:"primary"},{default:r(()=>e[13]||(e[13]=[m(" 新鱼种 ",-1)])),_:1,__:[13]})):p("",!0)]),t("div",Te,[o(a,{type:"default",size:"small",icon:"share-o",onClick:S(g=>j(i),["stop"])},{default:r(()=>e[14]||(e[14]=[m(" 分享 ",-1)])),_:2,__:[14]},1032,["onClick"]),o(a,{type:"default",size:"small",icon:"edit",onClick:S(g=>U(),["stop"])},{default:r(()=>e[15]||(e[15]=[m(" 编辑 ",-1)])),_:2,__:[15]},1032,["onClick"]),o(a,{type:"default",size:"small",icon:"delete-o",onClick:S(g=>W(i),["stop"])},{default:r(()=>e[16]||(e[16]=[m(" 删除 ",-1)])),_:2,__:[16]},1032,["onClick"])])],8,me))),128)),b.value.length===0?(l(),c("div",be,[o(Q,{description:"暂无钓获记录"},{default:r(()=>[o(a,{type:"primary",onClick:e[5]||(e[5]=i=>s.$router.push("/record/add"))},{default:r(()=>e[17]||(e[17]=[m(" 添加第一条记录 ",-1)])),_:1,__:[17]})]),_:1})])):p("",!0)])])}}});const Ae=K(Ie,[["__scopeId","data-v-7a142136"]]);export{Ae as default};
