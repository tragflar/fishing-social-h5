#!/bin/bash

# æ¸”å‹åœˆ - ç®€å•å¤–ç½‘è®¿é—®è„šæœ¬
echo "ðŸŒ æ¸”å‹åœˆå¤–ç½‘è®¿é—®"
echo "=================="

# æ£€æŸ¥æœ¬åœ°æœåŠ¡å™¨
if ! curl -s http://localhost:3000 > /dev/null; then
    echo "âŒ æœ¬åœ°æœåŠ¡å™¨æœªè¿è¡Œï¼Œè¯·å…ˆå¯åŠ¨ï¼špnpm dev"
    exit 1
fi

echo "âœ… æœ¬åœ°æœåŠ¡å™¨è¿è¡Œæ­£å¸¸"
echo ""

# æ˜¾ç¤ºå±€åŸŸç½‘è®¿é—®åœ°å€
echo "ðŸ“¡ å±€åŸŸç½‘è®¿é—®åœ°å€ï¼š"
echo "ðŸŒ http://10.191.41.50:3000"
echo ""

# å¯åŠ¨ localtunnel
echo "ðŸš€ å¯åŠ¨å¤–ç½‘éš§é“..."
echo "æ­£åœ¨ç”Ÿæˆå¤–ç½‘è®¿é—®åœ°å€..."

# ä½¿ç”¨éšæœºåŸŸåå¯åŠ¨ localtunnel
lt --port 3000 &
LT_PID=$!

# ç­‰å¾…éš§é“å»ºç«‹
sleep 3

echo ""
echo "âœ… å¤–ç½‘è®¿é—®åœ°å€å·²ç”Ÿæˆ"
echo "ðŸ“± æ‰‹æœº/ç”µè„‘è®¿é—®ï¼šæŸ¥çœ‹ä¸Šæ–¹è¾“å‡ºçš„åœ°å€"
echo ""
echo "ðŸ’¡ æç¤ºï¼š"
echo "1. å¦‚æžœè®¿é—®éœ€è¦å¯†ç ï¼Œè¯·å°è¯•åˆ·æ–°é¡µé¢"
echo "2. å¦‚æžœæ— æ³•è®¿é—®ï¼Œè¯·ç­‰å¾…å‡ ç§’é’ŸåŽé‡è¯•"
echo "3. æŒ‰ Ctrl+C åœæ­¢å¤–ç½‘è®¿é—®"
echo ""

# ç­‰å¾…ç”¨æˆ·ä¸­æ–­
trap "echo ''; echo 'ðŸ›‘ æ­£åœ¨åœæ­¢å¤–ç½‘è®¿é—®...'; kill $LT_PID 2>/dev/null; exit 0" INT
wait 